## 功能规划（MVP → GA）

### 里程碑
- MVP：完成最小可用的 MCP Server/Client（stdio 传输、工具调用、资源/提示列表、初始化/关停）
- Beta：新增 WebSocket 传输、中间件、可观测性、完整测试与示例
- GA：性能优化、稳定性增强、NuGet 发布、文档完善

### 核心协议与模型
- [ ] 定义错误码与错误类型枚举，统一错误处理策略
- [x] Capabilities/Initialize/Shutdown/Lifecycle 约定与校验
- [x] JSON 序列化配置（大小写策略、忽略空值、数字/时间处理）
- [ ] 消息校验（必填字段、Schema 校验钩子）

### 传输层（抽象 ITransport）
- [x] Stdio 传输（默认，支持 FastMCP 生态）
- [x] WebSocket 传输（可选，便于远程/浏览器桥接）
- [ ] 命名管道（Windows 可选）
- [ ] 背压与缓冲策略、取消/超时、心跳与重连

### 服务器（AxolotlMCP.Server）
- [x] HostBuilder 集成（DI/Logging/Options）
- [x] 消息路由器（请求/通知 → 处理器）
- [x] 工具注册与调用（同步/异步、超时、异常编排）
- [ ] 资源注册与订阅（listChanged、subscribe）
- [ ] 提示注册与模板参数渲染
- [x] 中间件管道（日志、鉴权、限流、审计）
- [x] 管道与接口（RequestMiddlewarePipeline/IRequestMiddleware）
- [x] 示例中间件：Timing、RateLimit（并发限流）
- [ ] 并发模型与任务调度（避免阻塞、可配置并发度）

### 客户端（AxolotlMCP.Client）
- [ ] 连接管理（建立/重连/关闭）
- [x] 请求-响应关联（Id 映射、超时/重试）
- [ ] 通知处理订阅（事件/回调）
- [ ] 工具/资源/提示发现与调用 API
- [ ] 客户端中间件（重试、指标、日志）

### 工具体系（Tooling）
- [ ] 基于特性/约定的工具描述与自动注册
- [ ] DTO → JsonSchema 自动生成（可选）
- [ ] 工具沙箱与资源配额（可选）
- [ ] 工具执行上下文（TraceId、用户、会话信息）

### 资源与提示（Resources/Prompts）
- [x] 注册与列举（ResourceRegistry/PromptRegistry）
- [ ] 订阅与变更通知
- [ ] 与默认处理器集成的 API
  - 详见：docs/资源与提示.md

### 配置（Options）
- [x] Options 模型（传输、并发、超时、重试、日志级别）
- [x] appsettings.json / 环境变量绑定
- [x] 示例配置同步到 `samples/`

### 可观测性（Observability）
- [x] 结构化日志（请求/响应/错误摘要）
- [x] 指标（请求时延、QPS、成功率、异常率）
- [x] OpenTelemetry Tracing（可选，跨进程链路）

### 安全
- [ ] 输入校验与长度限制（工具参数、资源标识）
- [ ] 基础鉴权钩子（可选）
- [ ] DoS 防护（队列长度/并发限制/超时）

### 文档与示例
- [x] README 快速开始（Server/Client 使用）
- [x] 按传输分类的示例：stdio / WebSocket（目前提供 stdio 示例）
- [x] 工具/资源/提示完整示例（echo 工具）
- [x] 架构/扩展点文档（docs/）

### 测试与基准
- [x] 单元测试（协议/路由/工具调用/超时）
- [ ] 集成测试（Server-Client 循环）
- [ ] 契约测试（关键 JSON 结构）
- [ ] 基准测试（吞吐/时延/内存占用）
  - 详见：docs/基础测试.md

### 发布与兼容
- [ ] NuGet 打包（Core/Server/Client）
- [ ] 版本语义化（SemVer），.NET 8/9 双目标
- [ ] 变更记录（CHANGELOG），源链路与符号包

## 任务分解（优先级：高→中→低）
- 高：Stdio 传输、Server 路由、Client 关联、工具调用、初始化/关闭、基础测试与文档
- 中：资源/提示、WebSocket、可观测性、中间件、配置化
- 低：命名管道、安全扩展、Schema 自动生成、工具沙箱

## 交付物
- `AxolotlMCP.Core`：协议模型、接口、错误码、序列化配置
- `AxolotlMCP.Server`：Host/路由/注册/中间件/并发
- `AxolotlMCP.Client`：连接/调用/事件/中间件
- `examples/`：分传输示例与工具/资源/提示示例
- `tests/`：单测/集成/基准
- 文档：README、ARCHITECTURE、使用指南、扩展指南